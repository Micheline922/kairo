{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the KAIRO application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "The user's display name or preferred name."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the user account was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "displayName",
        "creationDate"
      ]
    },
    "JournalEntry": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "JournalEntry",
      "type": "object",
      "description": "Represents a single journal entry within the KAIRO application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the journal entry."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N JournalEntry)"
        },
        "title": {
          "type": "string",
          "description": "Title of the journal entry."
        },
        "content": {
          "type": "string",
          "description": "Content of the journal entry."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the journal entry was created.",
          "format": "date-time"
        },
        "lastModified": {
          "type": "string",
          "description": "Date and time the journal entry was last modified.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "content",
        "creationDate",
        "lastModified"
      ]
    },
    "PearlOfWisdom": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PearlOfWisdom",
      "type": "object",
      "description": "Represents a saved verse or 'Pearl of Wisdom' from the Bible.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the pearl of wisdom."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N PearlOfWisdom)"
        },
        "verseReference": {
          "type": "string",
          "description": "Reference to the Bible verse (e.g., John 3:16)."
        },
        "verseText": {
          "type": "string",
          "description": "Text of the Bible verse."
        },
        "notes": {
          "type": "string",
          "description": "User's notes or reflections on the verse."
        },
        "savedDate": {
          "type": "string",
          "description": "Date and time the verse was saved.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "verseReference",
        "verseText",
        "notes",
        "savedDate"
      ]
    },
    "FastingPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FastingPlan",
      "type": "object",
      "description": "Represents a user's fasting plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the fasting plan."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N FastingPlan)"
        },
        "startDate": {
          "type": "string",
          "description": "Start date of the fast.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "End date of the fast.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "description": "Type of fast (e.g., water fast, juice fast)."
        },
        "purpose": {
          "type": "string",
          "description": "Purpose of the fast (e.g., spiritual growth, healing)."
        },
        "readingPlan": {
          "type": "string",
          "description": "AI generated reading plan for the fast."
        }
      },
      "required": [
        "id",
        "userId",
        "startDate",
        "endDate",
        "type",
        "purpose"
      ]
    },
    "AcademyInsight": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AcademyInsight",
      "type": "object",
      "description": "Represents a saved explanation from the Academy.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the academy insight."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "concept": {
          "type": "string",
          "description": "The modern concept that was explained."
        },
        "explanation": {
          "type": "string",
          "description": "The AI-generated biblical explanation."
        },
        "relevantVerses": {
            "type": "string",
            "description": "Relevant bible verses for the explanation."
        },
        "savedDate": {
          "type": "string",
          "description": "Date and time the insight was saved.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "concept",
        "explanation",
        "savedDate"
      ]
    },
    "DivineGuidance": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DivineGuidance",
      "type": "object",
      "description": "Represents a saved piece of guidance from the Discernment tool.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the divine guidance."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "decisionContext": {
          "type": "string",
          "description": "The user's description of the decision."
        },
        "guidance": {
          "type": "string",
          "description": "The AI-generated biblical guidance."
        },
        "savedDate": {
          "type": "string",
          "description": "Date and time the guidance was saved.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "decisionContext",
        "guidance",
        "savedDate"
      ]
    },
    "PrayerRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PrayerRequest",
      "type": "object",
      "description": "Represents a single prayer request on the Prayer Wall.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the prayer request."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "requestText": {
          "type": "string",
          "description": "The content of the prayer request."
        },
        "isAnswered": {
          "type": "boolean",
          "description": "Whether the prayer has been marked as answered."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the prayer request was created.",
          "format": "date-time"
        },
        "answeredDate": {
          "type": "string",
          "description": "Date and time the prayer was marked as answered.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "requestText",
        "isAnswered",
        "creationDate"
      ]
    },
     "PrayerPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PrayerPlan",
      "type": "object",
      "description": "Represents a user's scheduled prayer plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the prayer plan."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "title": {
          "type": "string",
          "description": "Title for the prayer (e.g., 'Morning Devotion')."
        },
        "time": {
          "type": "string",
          "description": "The scheduled time for the prayer (e.g., 'Matin', '18:00')."
        },
        "intention": {
          "type": "string",
          "description": "The specific intention or focus of the prayer."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the prayer plan was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "time",
        "intention",
        "creationDate"
      ]
    },
    "WritersSanctuaryArticle": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WritersSanctuaryArticle",
      "type": "object",
      "description": "Represents an article written and enhanced in the Writer's Sanctuary.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the article."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "title": {
          "type": "string",
          "description": "The original title of the article."
        },
        "enhancedArticle": {
          "type": "string",
          "description": "The AI-enhanced content of the article."
        },
        "supportingVerses": {
          "type": "string",
          "description": "A list of relevant bible verses that support the article."
        },
        "savedDate": {
          "type": "string",
          "description": "Date and time the article was saved.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "enhancedArticle",
        "supportingVerses",
        "savedDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. The 'userId' parameter ensures that only the authenticated user can access their own profile data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/journalEntries/{journalEntryId}",
        "definition": {
          "entityName": "JournalEntry",
          "schema": {
            "$ref": "#/backend/entities/JournalEntry"
          },
          "description": "Stores journal entries for each user. The 'userId' parameter ensures that only the authenticated user can access their own journal entries.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "journalEntryId",
              "description": "The unique identifier for the journal entry."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/pearlsOfWisdom/{pearlOfWisdomId}",
        "definition": {
          "entityName": "PearlOfWisdom",
          "schema": {
            "$ref": "#/backend/entities/PearlOfWisdom"
          },
          "description": "Stores saved Bible verses (Pearls of Wisdom) for each user. The 'userId' parameter ensures that only the authenticated user can access their own saved verses.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "pearlOfWisdomId",
              "description": "The unique identifier for the pearl of wisdom."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/fastingPlans/{fastingPlanId}",
        "definition": {
          "entityName": "FastingPlan",
          "schema": {
            "$ref": "#/backend/entities/FastingPlan"
          },
          "description": "Stores fasting plans for each user. The 'userId' parameter ensures that only the authenticated user can access their own fasting plans.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "fastingPlanId",
              "description": "The unique identifier for the fasting plan."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/academyInsights/{academyInsightId}",
        "definition": {
          "entityName": "AcademyInsight",
          "schema": {
            "$ref": "#/backend/entities/AcademyInsight"
          },
          "description": "Stores saved explanations from the Academy for each user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "academyInsightId",
              "description": "The unique identifier for the academy insight."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/divineGuidances/{divineGuidanceId}",
        "definition": {
          "entityName": "DivineGuidance",
          "schema": {
            "$ref": "#/backend/entities/DivineGuidance"
          },
          "description": "Stores saved guidance from the Discernment tool for each user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "divineGuidanceId",
              "description": "The unique identifier for the divine guidance."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/prayerRequests/{prayerRequestId}",
        "definition": {
          "entityName": "PrayerRequest",
          "schema": {
            "$ref": "#/backend/entities/PrayerRequest"
          },
          "description": "Stores prayer requests for each user on their Prayer Wall.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "prayerRequestId",
              "description": "The unique identifier for the prayer request."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/prayerPlans/{prayerPlanId}",
        "definition": {
          "entityName": "PrayerPlan",
          "schema": {
            "$ref": "#/backend/entities/PrayerPlan"
          },
          "description": "Stores prayer plans for each user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "prayerPlanId",
              "description": "The unique identifier for the prayer plan."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/writersSanctuary/{articleId}",
        "definition": {
          "entityName": "WritersSanctuaryArticle",
          "schema": {
            "$ref": "#/backend/entities/WritersSanctuaryArticle"
          },
          "description": "Stores articles from the Writer's Sanctuary for each user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "articleId",
              "description": "The unique identifier for the article."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure data privacy and security for the KAIRO application, with a focus on authorization independence and ease of debugging. User data and their associated journal entries, pearls of wisdom, and fasting plans are stored under user-specific paths to enforce strict privacy. This design eliminates the need for complex security rules and enables secure list operations (QAPs). Authorization Independence is achieved by storing each user's data under their respective `userId`, removing the need to check parent document properties for authorization. This approach simplifies security rules to `request.auth.uid == resource.data.userId` and enables atomic batch operations. The structure is segregated by entity type, and the use of hierarchical paths makes security rules more manageable."
  }
}
